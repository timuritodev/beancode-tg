# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ 409 Conflict

## –ü—Ä–æ–±–ª–µ–º–∞
```
409 Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
```

–≠—Ç–∞ –æ—à–∏–±–∫–∞ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∑–∞–ø—É—â–µ–Ω–æ **–Ω–µ—Å–∫–æ–ª—å–∫–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ –±–æ—Ç–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ**. Telegram API –Ω–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç —ç—Ç–æ.

## –†–µ—à–µ–Ω–∏–µ

### 1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ª–æ–∫–∞–ª—å–Ω—ã–π –±–æ—Ç (–µ—Å–ª–∏ –∑–∞–ø—É—â–µ–Ω)

–ù–∞ –≤–∞—à–µ–º –ª–æ–∫–∞–ª—å–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ:
```bash
# –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ nodemon, –Ω–∞–∂–º–∏—Ç–µ Ctrl+C
# –ò–ª–∏ –Ω–∞–π–¥–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å –∏ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –µ–≥–æ
ps aux | grep "node index.js"
kill <PID>
```

### 2. –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –±–æ—Ç–∞

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã PM2
pm2 list

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å—ã Node.js
ps aux | grep "beancode-tg\|telegram-bot\|index.js"

# –ï—Å–ª–∏ –Ω–∞–π–¥–µ—Ç–µ –¥—É–±–ª–∏–∫–∞—Ç—ã, –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∏—Ö
pm2 stop beancode-telegram-bot
pm2 delete beancode-telegram-bot
```

### 3. –û–±–Ω–æ–≤–∏—Ç–µ PM2 –∫–æ–Ω—Ñ–∏–≥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ `pm2.config.cjs` –µ—Å—Ç—å `exec_mode: 'fork'`:

```javascript
exec_mode: 'fork', // –Ø–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞–µ–º fork —Ä–µ–∂–∏–º (–Ω–µ cluster)
```

### 4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

```bash
cd ~/beancode-tg

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å—Ç–∞—Ä—ã–π –ø—Ä–æ—Ü–µ—Å—Å
pm2 stop beancode-telegram-bot
pm2 delete beancode-telegram-bot

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å –Ω–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
pm2 start pm2.config.cjs

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –∑–∞–ø—É—â–µ–Ω —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä –≤ —Ä–µ–∂–∏–º–µ fork
pm2 list

# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
# ‚îÇ 2  ‚îÇ beancode-telegram‚Ä¶ ‚îÇ fork     ‚îÇ 0    ‚îÇ online    ‚îÇ
# –ù–ï cluster!
```

### 5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏

```bash
pm2 logs beancode-telegram-bot --lines 20
```

–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
```
ü§ñ Telegram bot is running...
```

–ë–µ–∑ –æ—à–∏–±–æ–∫ 409!

## –ü—Ä–æ–≤–µ—Ä–∫–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ Telegram
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –±–æ—Ç—É `/start`
3. –î–æ–ª–∂–µ–Ω –æ—Ç–≤–µ—Ç–∏—Ç—å –±–µ–∑ –æ—à–∏–±–æ–∫

